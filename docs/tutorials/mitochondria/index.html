<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/octopus/blog/rss.xml" title="Octopus Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/octopus/blog/atom.xml" title="Octopus Blog Atom Feed"><title data-react-helmet="true">Mitochondria | Octopus</title><meta data-react-helmet="true" property="og:url" content="https://luntergroup.github.io/octopus/docs/tutorials/mitochondria"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Mitochondria | Octopus"><meta data-react-helmet="true" name="description" content="This case study considers Mitochondria variant calling. We will call and benchmark variants in the mixture sample described in Fazzini et al.."><meta data-react-helmet="true" property="og:description" content="This case study considers Mitochondria variant calling. We will call and benchmark variants in the mixture sample described in Fazzini et al.."><link data-react-helmet="true" rel="shortcut icon" href="/octopus/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://luntergroup.github.io/octopus/docs/tutorials/mitochondria"><link data-react-helmet="true" rel="alternate" href="https://luntergroup.github.io/octopus/docs/tutorials/mitochondria" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://luntergroup.github.io/octopus/docs/tutorials/mitochondria" hreflang="x-default"><link rel="stylesheet" href="/octopus/assets/css/styles.0d769f7d.css">
<link rel="preload" href="/octopus/assets/js/runtime~main.82d64c00.js" as="script">
<link rel="preload" href="/octopus/assets/js/main.668a8a5c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_RReh"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/octopus/"><img src="/octopus/img/octopus.svg" alt="Octopus Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/octopus/img/octopus_keytar.svg" alt="Octopus Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Octopus</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/octopus/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/octopus/docs/cli">Command line</a><a class="navbar__item navbar__link" href="/octopus/docs/publications">Publications</a><a class="navbar__item navbar__link" href="/octopus/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/luntergroup/octopus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/octopus/"><img src="/octopus/img/octopus.svg" alt="Octopus Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/octopus/img/octopus_keytar.svg" alt="Octopus Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Octopus</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/octopus/docs/introduction">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/octopus/docs/cli">Command line</a></li><li class="menu__list-item"><a class="menu__link" href="/octopus/docs/publications">Publications</a></li><li class="menu__list-item"><a class="menu__link" href="/octopus/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/luntergroup/octopus" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0 sidebarWithHideableNavbar_VlPv"><a tabindex="-1" class="sidebarLogo_hmkv" href="/octopus/"><img src="/octopus/img/octopus.svg" alt="Octopus Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/octopus/img/octopus_keytar.svg" alt="Octopus Logo" class="themedImage_TMUO themedImage--dark_uzRr"><strong>Octopus</strong></a><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/octopus/docs/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/octopus/docs/installation">Installation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/preprocessing">Read Preprocessing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/discovery">Variant Discovery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/haplotypes">Haplotype Proposal</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Calling Models</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/models/individual">Individual</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/models/trio">Trio</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/models/population">Population</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/models/cancer">Cancer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/models/polyclone">Polyclone</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/models/cell">Cell</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/errorModels">Error Models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/phasing">Phasing</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Filtering</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/filtering/annotations">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/filtering/forest">Random Forest</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/filtering/thresholds">Hard Thresholds</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/bamout">Realigned BAMs</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Advanced</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/advanced/targeted">Targeted Calling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/advanced/threading">Multithreading</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/advanced/memory">Memory Use</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/advanced/vcf">VCF Format</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/octopus/docs/guides/advanced/configs">Config files</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Case studies</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/octopus/docs/tutorials/germline">Germline WGS</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/octopus/docs/tutorials/mitochondria">Mitochondria</a></li></ul></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">Mitochondria</h1></header><div class="markdown"><p>This case study considers Mitochondria variant calling. We will call and benchmark variants in the mixture sample described in <a href="https://www.mdpi.com/1422-0067/22/2/935" target="_blank" rel="noopener noreferrer">Fazzini et al.</a>.</p><p>This tutorial is <a target="_blank" href="/octopus/assets/files/mitochondria-71f7c758993381f29a37f8e9868e4b6f.smk">included</a> as a <a href="https://snakemake.readthedocs.io/en/stable/#" target="_blank" rel="noopener noreferrer">Snakemake</a> workflow. Run it with</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ snakemake --snakefile mitochondria.smk -j </span><span class="token number" style="color:rgb(247, 140, 108)">16</span><span class="token plain"> --use-singularity</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h2><ul><li><a href="https://github.com/samtools/samtools" target="_blank" rel="noopener noreferrer">samtools</a></li><li><a href="https://github.com/samtools/bcftools" target="_blank" rel="noopener noreferrer">bcftools</a></li><li><a href="https://github.com/lh3/bwa" target="_blank" rel="noopener noreferrer">BWA</a></li><li><a href="https://github.com/RealTimeGenomics/rtg-tools" target="_blank" rel="noopener noreferrer">RTG Tools</a></li><li><a href="https://github.com/luntergroup/octopus" target="_blank" rel="noopener noreferrer">Octopus</a> (with <a href="/octopus/docs/guides/filtering/forest">random forests</a> installed).</li></ul><p>This tutorial assumes a directory structure like</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><div tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â””â”€â”€â”€data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”‚   â””â”€â”€â”€references</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”‚   â””â”€â”€â”€reads</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”‚   â”‚   â””â”€â”€â”€raw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”‚   â”‚   â””â”€â”€â”€mapped</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”‚   â””â”€â”€â”€truth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â””â”€â”€â”€results</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€â”€â”€calls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€â”€â”€eval</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>We&#x27;ll go ahead and create this upfront:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> -p data/</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">references,truth</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> data/reads/</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">raw,mapped</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> -p results/</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">calls,eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="download-data"></a>Download data<a class="hash-link" href="#download-data" title="Direct link to heading">#</a></h2><p>First, download PCR-amplified mitochondria Illumina MiSeq reads:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -o data/reads/raw/H1_U5.M4-Herk_S41.R1.fastq.gz https://zenodo.org/record/3991749/files/M4-Herk_S41_R1_001.fastq.gz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -o data/reads/raw/H1_U5.M4-Herk_S41.R2.fastq.gz https://zenodo.org/record/3991749/files/M4-Herk_S41_R2_001.fastq.gz</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Next, we need a reference genome. For this tutorial we&#x27;ll use GRCh38 with ALT and decoys contigs (hs38DH), which includes the revised Cambridge Reference Sequence (rCRS). The simplest way to get this is with <code>bwakit</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ run-gen-ref hs38DH</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">mv</span><span class="token plain"> hs38DH.fa* data/references</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>We&#x27;ll also need the truth variants to evaluate our calls, Fazzini et al. provide these in <a href="https://www.mdpi.com/1422-0067/22/2/935/s1?version=1611043746" target="_blank" rel="noopener noreferrer">Supplementary Table S7</a>. However, since we&#x27;ll need a VCF for benchmarking, we have manually translated these variants into VCF, which can be downloaded using:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -o data/truth/H1_U5.vcf.gz https://github.com/luntergroup/octopus/blob/develop/website/static/assets/H1_U5.vcf.gz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -o data/truth/H1_U5.vcf.gz.tbi https://github.com/luntergroup/octopus/blob/develop/website/static/assets/H1_U5.vcf.gz.tbi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -o data/truth/H1_U5.highconf.bed https://github.com/luntergroup/octopus/blob/develop/website/static/assets/H1_U5.highconf.bed</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="map-reads"></a>Map reads<a class="hash-link" href="#map-reads" title="Direct link to heading">#</a></h2><p>First, we need to index the reference genome for alignment:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ samtools faidx data/references/hs38DH.fa</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ bwa index data/references/hs38DH.fa</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Next, we map the raw reads to the reference genome with <code>bwa mem</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ bwa mem </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     -R </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;@RG</span><span class="token string entity" style="color:rgb(195, 232, 141)">\t</span><span class="token string" style="color:rgb(195, 232, 141)">ID:S41</span><span class="token string entity" style="color:rgb(195, 232, 141)">\t</span><span class="token string" style="color:rgb(195, 232, 141)">SM:H1_U5</span><span class="token string entity" style="color:rgb(195, 232, 141)">\t</span><span class="token string" style="color:rgb(195, 232, 141)">LB:M4</span><span class="token string entity" style="color:rgb(195, 232, 141)">\t</span><span class="token string" style="color:rgb(195, 232, 141)">PU:Illumina&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     data/reference/hs38DH.fa </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     data/reads/raw/H1_U5.M4-Herk_S41.R1.fastq.gz data/reads/raw/H1_U5.M4-Herk_S41.R2.fastq.gz </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     samtools view -bh </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     samtools </span><span class="token function" style="color:rgb(130, 170, 255)">sort</span><span class="token plain"> -o data/reads/mapped/H1_U5.M4-Herk_S41.hs38DH.bam -</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ samtools index data/reads/mapped/H1_U5.M4-Herk_S41.hs38DH.bam</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>This should complete in less than a minute.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="call-variants"></a>Call variants<a class="hash-link" href="#call-variants" title="Direct link to heading">#</a></h2><p>Now we can call variants with <code>octopus</code>. Since we&#x27;re aiming to call homoplasmic and heteroplasmic mitochondria variants, we&#x27;ll be using the <a href="/octopus/docs/guides/models/polyclone">polyclone</a> calling model. We&#x27;ll use the provided mitochondria <a href="/octopus/docs/guides/advanced/configs">config</a> which sets several options. We&#x27;ll also set the <a href="/octopus/docs/guides/errorModels">sequence error model</a> to reflect the PCR amplified library design of this sample. Finally, we <a href="/octopus/docs/guides/advanced/targeted">restrict calling</a> to the mitochondria reference genome and use built-in <a href="/octopus/docs/guides/advanced/threading">multithreading</a>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ octopus </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     -R data/reference/hs38DH.fa </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     -I data/reads/mapped/H1_U5.M4-Herk_S41.hs38DH.bam </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     -T chrM </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     --config /opt/octopus/resources/configs/mitochondria.config </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     --sequence-error-model PCR </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     -o results/calls/H1_U5.M4-PCR-Herk_S14.hs38DH.octopus.vcf.gz </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     --threads </span><span class="token number" style="color:rgb(247, 140, 108)">8</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>This should complete in ~30 minutes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="evaluate-variants"></a>Evaluate variants<a class="hash-link" href="#evaluate-variants" title="Direct link to heading">#</a></h2><p>Finally, we will evaluate our calls with RTG Tools <code>vcfeval</code>. This tool requires the reference sequence to be preprocessed:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ rtg </span><span class="token function" style="color:rgb(130, 170, 255)">format</span><span class="token plain"> -o ~/reference/hs38DH.sdf ~/reference/hs38DH.fa</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Then evaluate the calls with <code>vcfeval</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ rtg vcfeval </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     -t data/reference/hs38DH.sdf </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     -b data/truth/H1_U5.vcf.gz </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     --evaluation-regions data/truth/H1_U5.highconf.bed </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     -c results/calls/H1_U5.M4-PCR-Herk_S14.hs38DH.octopus.vcf.gz </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     -o results/eval/H1_U5.M4-PCR-Herk_S14.hs38DH.octopus.pass.alt.vcfeval </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     --sample ALT </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     -m annotate </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     --ref-overlap</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>We should see the following results:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Threshold  True-pos-baseline  True-pos-call  False-pos  False-neg  Precision  Sensitivity  F-measure</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">----------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     None                 </span><span class="token number" style="color:rgb(247, 140, 108)">38</span><span class="token plain">             </span><span class="token number" style="color:rgb(247, 140, 108)">38</span><span class="token plain">          </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">          </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain">     </span><span class="token number" style="color:rgb(247, 140, 108)">0.9744</span><span class="token plain">       </span><span class="token number" style="color:rgb(247, 140, 108)">0.9048</span><span class="token plain">     </span><span class="token number" style="color:rgb(247, 140, 108)">0.9383</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/${organizationName}/${projectName}/edit/${branch}/website/docs/tutorials/mitochondria.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/octopus/docs/tutorials/germline"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Germline WGS</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link">Prerequisites</a></li><li><a href="#download-data" class="table-of-contents__link">Download data</a></li><li><a href="#map-reads" class="table-of-contents__link">Map reads</a></li><li><a href="#call-variants" class="table-of-contents__link">Call variants</a></li><li><a href="#evaluate-variants" class="table-of-contents__link">Evaluate variants</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/octopus/docs/installation">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/octopus/docs/cli">Command Line</a></li><li class="footer__item"><a class="footer__link-item" href="/octopus/docs/tutorials/germline">Case Studies</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.biostars.org/tag/octopus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Biostars</a></li><li class="footer__item"><a href="https://gitter.im/octopus-caller/Lobby" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitter</a></li><li class="footer__item"><a href="https://twitter.com/octopus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/octopus/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/luntergroup/octopus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Daniel Cooke. Built with Docusaurus.</div></div></div></footer></div>
<script src="/octopus/assets/js/runtime~main.82d64c00.js"></script>
<script src="/octopus/assets/js/main.668a8a5c.js"></script>
</body>
</html>